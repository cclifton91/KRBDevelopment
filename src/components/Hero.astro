---
import heroInfo from "../data/homepage.json"
import { Image } from "astro:assets"
import { Icon } from "astro-icon/components"
import defaultHeroImg from "../assets/heroImage.jpg"

// Create a mapping of all images in the assets directory
const images = import.meta.glob("../assets/*.{jpeg,jpg,png,gif}", { import: "default" })

// Extract just the filename from the path in JSON
const heroImgPath = heroInfo.heroImg
const heroImgFilename = heroImgPath.split("/").pop()
const fullImagePath = `../assets/${heroImgFilename}`

// Use the default image as fallback
let heroImg = defaultHeroImg

// Try to get the image from the mapping
if (images[fullImagePath]) {
	try {
		const importedImage = await images[fullImagePath]()

		if (
			importedImage &&
			typeof importedImage === "object" &&
			"src" in importedImage &&
			"width" in importedImage &&
			"height" in importedImage &&
			"format" in importedImage &&
			typeof importedImage.src === "string" &&
			typeof importedImage.width === "number" &&
			typeof importedImage.height === "number" &&
			typeof importedImage.format === "string"
		) {
			heroImg = importedImage as ImageMetadata
		}
	} catch (error) {
		console.error("Failed to load image:", error)
	}
}
const { heading = heroInfo.heroText, description = heroInfo.heroDescription } = Astro.props
---

<section id="home" class="pb-24 bg-black relative overflow-hidden" x-data="{ mobileNavOpen: false }">
	<nav class="relative py-10 z-10" data-config-="data-config-">
		<div class="container px-4 mx-auto">
			<div class="flex items-center justify-between relative">
				<!-- Logo -->
				<a class="inline-block" href="#home"><Icon name="KRBsvg" class="w-24 h-24" /></a>
				<!-- Desktop Navigation -->
				<ul class="hidden lg:flex ml-auto space-x-8">
					<li><a class="inline-block font-bold hover:text-red-900" aria-current="page" href="#home">Home</a></li>
					<li><a class="inline-block font-bold hover:text-red-900" aria-label="to about section" href="#about">About</a></li>
					<li><a class="inline-block font-bold hover:text-red-900" aria-label="to bids section" href="#bids">Bids</a></li>
				</ul>
				<!-- Contact Button -->
				<div class="hidden lg:block ml-8"><a class="inline-block px-8 py-3 text-white font-bold bg-yellow-600 hover:bg-yellow-700" aria-label="to contact form" href="#contact">Contact</a></div>
				<!-- Mobile Menu Button -->
				<button x-on:click="mobileNavOpen = !mobileNavOpen" class="lg:hidden">
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path
							fill-rule="evenodd"
							clip-rule="evenodd"
							d="M3.5 7C3.22386 7 3 6.77614 3 6.5C3 6.22386 3.22386 6 3.5 6H20.5C20.7761 6 21 6.22386 21 6.5C21 6.77614 20.7761 7 20.5 7H3.5ZM3.5 12C3.22386 12 3 11.7761 3 11.5C3 11.2239 3.22386 11 3.5 11H20.5C20.7761 11 21 11.2239 21 11.5C21 11.7761 20.7761 12 20.5 12H3.5ZM3 16.5C3 16.7761 3.22386 17 3.5 17H20.5C20.7761 17 21 16.7761 21 16.5C21 16.2239 20.7761 16 20.5 16H3.5C3.22386 16 3 16.2239 3 16.5Z"
							fill="#000"></path>
					</svg>
				</button>
			</div>
		</div>
	</nav>
	<div class="container px-4 mx-auto relative z-10">
		<div class="flex flex-wrap -mx-4 mb-20 items-center">
			<div class="w-full lg:w-1/2 xl:w-2/3 px-4 mb-6 lg:mb-0">
				<h1 class="text-5xl lg:text-6xl xl:text-8xl font-heading mb-6">Build With The <span class="text-yellow-600">Community</span> In Mind</h1>
			</div>
			<div class="w-full lg:w-1/2 xl:w-1/3 px-4">
				<p class="leading-8 max-w-sm">{description}</p>
			</div>
		</div>
		<div><Image src={heroImg} loading="eager" class="block mb-10 object-cover h-[500px]" alt="row of houses in chicago" /></div>
	</div>
	<div class="py-72 md:py-80 absolute top-0 left-0 w-full bg-white"></div>
	<div :class="{'block': mobileNavOpen, 'hidden': !mobileNavOpen}" class="hidden fixed top-0 left-0 bottom-0 w-3/4 max-w-xs z-50" data-config-="data-config-">
		<div x-on:click="mobileNavOpen = !mobileNavOpen" class="fixed inset-0 bg-black bg-opacity-75"></div>
		<nav class="relative flex flex-col h-full p-8 bg-white">
			<div class="flex items-center justify-between mb-12">
				<a class="items-center" href="#home" aria-label="to top"><Icon name="KRBsvg" class="w-24 h-24" /></a>
				<button x-on:click="mobileNavOpen = !mobileNavOpen" class="inline-block focus:outline-none" type="button" aria-label="Close">
					<Icon name="x2" />
				</button>
			</div>
			<div>
				<ul>
					<li class="py-3"><a class="inline-block font-bold hover:text-red-900" href="#">Home</a></li>
					<li class="py-3"><a class="inline-block font-bold hover:text-red-900" href="#">About</a></li>
					<li class="py-3"><a class="inline-block font-bold hover:text-red-900" href="#">Bids</a></li>
				</ul>
			</div>
			<div class="mt-auto">
				<div>
					<a class="block px-8 py-3 text-center text-white font-bold bg-yellow-600 hover:bg-yellow-700" href="#">Contact</a>
				</div>
			</div>
		</nav>
	</div>
</section>
